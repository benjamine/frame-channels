{"version":3,"file":"bundle.js","sources":["/source-files/frame-channels/../fiberglass/node_modules/browserify/node_modules/browser-pack/_prelude.js","/source-files/frame-channels/src/main.js","/source-files/frame-channels/package.json","/source-files/frame-channels/../fiberglass/node_modules/browserify/node_modules/process/browser.js","/source-files/frame-channels/src/channel.js","/source-files/frame-channels/src/channel-iframe.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/main.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/promise.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/polyfill.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/config.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/utils.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/all.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/race.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/resolve.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/reject.js","/source-files/frame-channels/node_modules/es6-promise/dist/commonjs/promise/asap.js"],"names":["noop","process","module","exports","nextTick","canSetImmediate","window","setImmediate","canPost","postMessage","addEventListener","f","queue","ev","source","data","stopPropagation","length","fn","shift","push","setTimeout","title","browser","env","argv","on","addListener","once","off","removeListener","removeAllListeners","emit","binding","Error","cwd","chdir","Channel","name","options","this","handlers","listening","isReady","iframe","ChannelIFrame","waitMessageResponse","self","id","timeout","resolve","reject","_myWindow","findMyWindow","listener","event","channel","originIsAllowed","origin","_responseTo","removeEventListener","error","err","responseTimeout","handleMessage","message","handler","respond","response","resp","value","_messageid","console","stack","Promise","require","messageCount","prototype","myWindow","findWindow","_window","target","element","document","querySelector","contentWindow","msg","targetOrigin","request","filter","originFilter","test","subscribe","Array","slice","apply","respondToPings","autoReady","notifyReady","respondingToPings","ping","pong","ready","unsubscribe","i","splice","promise","readyPromise","readyListener","getElementById","log","createElement","style","display","allowPositionControl","subscribeToPositionMessages","body","appendChild","url","src","html","doc","contentDocument","write","toString","close","setup","readyTimeout","maximize","size","width","height","restore","dock","show","hide","preMaximize","location","left","indexOf","right","bottom","top","position","margin","padding","border","zIndex","pre","focus","polyfill","resolver","isFunction","TypeError","_subscribers","invokeResolver","resolvePromise","rejectPromise","reason","e","invokeCallback","settled","callback","detail","succeeded","failed","hasCallback","handleThenable","FULFILLED","REJECTED","parent","child","onFulfillment","onRejection","subscribers","publish","_detail","resolved","then","objectOrFunction","call","val","fulfill","_state","PENDING","SEALED","config","async","publishFulfillment","publishRejection","configure","now","all","race","staticResolve","staticReject","asap","counter","constructor","undefined","thenPromise","callbacks","arguments","catch","global","local","es6PromiseSupport","r","RSVPPromise","instrument","x","isArray","Object","Date","getTime","promises","index","resolveAll","results","remaining","useNextTick","flush","useMutationObserver","iterations","observer","BrowserMutationObserver","node","createTextNode","observe","characterData","useSetTimeout","tuple","arg","scheduleFlush","browserGlobal","MutationObserver","WebKitMutationObserver"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function(e){var r=require(\"./channel\");exports.Channel=r,exports.create=function(e,o){return new r(e,o)};var o=\"undefined\"!=typeof e&&\"string\"==typeof e.execPath;if(o){var a=require(\"../package.json\");exports.version=a.version,exports.homepage=a.homepage}else exports.homepage=\"{{package-homepage}}\",exports.version=\"{{package-version}}\"}).call(this,require(\"_process\"));","module.exports={\n  \"name\": \"frame-channels\",\n  \"version\": \"0.0.57\",\n  \"description\": \"pub/sub channels between browser [i]frames\",\n  \"main\": \"./src/main\",\n  \"scripts\": {\n    \"test\": \"gulp test && gulp test-browser\",\n    \"cover\": \"istanbul cover --root src gulp test\",\n    \"cover-report\": \"open coverage/lcov-report/index.html\",\n    \"cover-publish\": \"istanbul cover _mocha --report lcovonly && codeclimate < coverage/lcov.info\",\n    \"bump\": \"gulp bump\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/benjamine/frame-channels.git\"\n  },\n  \"keywords\": [\n    \"pubsub\",\n    \"channel\",\n    \"frame\",\n    \"iframe\",\n    \"postmessage\"\n  ],\n  \"author\": \"Benjamin Eidelman <beneidel@gmail.com>\",\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/benjamine/frame-channels/issues\"\n  },\n  \"homepage\": \"https://github.com/benjamine/frame-channels\",\n  \"devDependencies\": {\n    \"brfs\": \"^1.2.0\",\n    \"codeclimate-test-reporter\": \"0.0.3\",\n    \"expect.js\": \"~0.3.1\",\n    \"fiberglass\": \"~0.0.4\",\n    \"gulp\": \"~3.8.6\",\n    \"istanbul\": \"^0.3.0\",\n    \"require-dir\": \"~0.1.0\"\n  },\n  \"testling\": {\n    \"harness\": \"mocha\",\n    \"files\": \"test/index.js\",\n    \"scripts\": [\n      \"build/frame-channels.js\"\n    ],\n    \"browsers\": [\n      \"ie/8..latest\",\n      \"chrome/27..latest\",\n      \"firefox/22..latest\",\n      \"safari/5.1..latest\",\n      \"opera/12..latest\",\n      \"iphone/6..latest\",\n      \"ipad/6..latest\",\n      \"android-browser/4.2..latest\"\n    ]\n  },\n  \"dependencies\": {\n    \"es6-promise\": \"^1.0.0\"\n  }\n}\n","// shim for using process in browser\n\nvar process = module.exports = {};\n\nprocess.nextTick = (function () {\n    var canSetImmediate = typeof window !== 'undefined'\n    && window.setImmediate;\n    var canPost = typeof window !== 'undefined'\n    && window.postMessage && window.addEventListener\n    ;\n\n    if (canSetImmediate) {\n        return function (f) { return window.setImmediate(f) };\n    }\n\n    if (canPost) {\n        var queue = [];\n        window.addEventListener('message', function (ev) {\n            var source = ev.source;\n            if ((source === window || source === null) && ev.data === 'process-tick') {\n                ev.stopPropagation();\n                if (queue.length > 0) {\n                    var fn = queue.shift();\n                    fn();\n                }\n            }\n        }, true);\n\n        return function nextTick(fn) {\n            queue.push(fn);\n            window.postMessage('process-tick', '*');\n        };\n    }\n\n    return function nextTick(fn) {\n        setTimeout(fn, 0);\n    };\n})();\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n}\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\n","\nvar Promise = require('es6-promise').Promise;\nvar ChannelIFrame = require('./channel-iframe');\nvar messageCount = 0;\n\nfunction Channel(name, options) {\n  this.options = options || {};\n  if (typeof name !== 'string' || name.length < 1) {\n    throw new Error('name must be a non-empty string');\n  }\n  this.name = name;\n  this.options = options || {};\n  this.handlers = [];\n  this.listening = false;\n  this.isReady = false;\n  if (this.options.iframe) {\n    this.iframe = new ChannelIFrame(this);\n  }\n}\n\nChannel.prototype.findMyWindow = function () {\n  if (this._myWindow) {\n    return this._myWindow;\n  }\n  var myWindow = this.options.myWindow;\n  if (myWindow && typeof myWindow.addEventListener === 'function') {\n    this._myWindow = myWindow;\n    return this._myWindow;\n  }\n  this._myWindow = window;\n  return this._myWindow;\n};\n\nChannel.prototype.findWindow = function () {\n  if (this._window) {\n    return this._window;\n  }\n  var target = this.options.target;\n  if (!target && this.options.iframe && this.options.iframe.id) {\n    target = '#' + this.options.iframe.id;\n  }\n  if (typeof target === 'string') {\n    var element = document.querySelector(target);\n    if (!element || !element.contentWindow) {\n      throw new Error('unable to find contentWindow of ' + target);\n    }\n    this._window = element.contentWindow;\n    return this._window;\n  }\n  if (target && typeof target.postMessage === 'function') {\n    this._window = target;\n    return this._window;\n  }\n  throw new Error('no valid target was provided (eg. #iframeIdOrSelector, window.parent, someWindow)');\n};\n\nfunction waitMessageResponse(self, id, timeout, resolve, reject) {\n\n  var _myWindow = self.findMyWindow();\n\n  var listener = function responseListener(event) {\n    if (!event.data || event.data.channel !== self.name) {\n      return;\n    }\n    if (!self.originIsAllowed(event.origin)) {\n      return;\n    }\n    if (event.data._responseTo === id) {\n      if (!listener) {\n        return;\n      }\n      _myWindow.removeEventListener('message', listener);\n      listener = null;\n      if (event.data && event.data.error) {\n        reject(new Error(event.data.error));\n      } else {\n        resolve(event.data);\n      }\n    }\n  };\n\n  _myWindow.addEventListener('message', listener, false);\n\n  setTimeout(function(){\n    if (!listener) {\n      return;\n    }\n    _myWindow.removeEventListener('message', listener);\n    listener = null;\n    var err = new Error('timeout waiting for cross-frame response');\n    err.timeout = true;\n    reject(err);\n  }, timeout || self.options.responseTimeout || 3000);\n}\n\nChannel.prototype.push = function(message) {\n  var msg = message;\n  if (typeof msg !== 'object') {\n    msg = { value: msg };\n  }\n  msg.channel = this.name;\n\n  messageCount++;\n  var id = msg._messageid = messageCount;\n\n  var _window = this.findWindow();\n  var self = this;\n  setTimeout(function(){\n    _window.postMessage(msg, self.options.targetOrigin || '*');\n  }, 1);\n\n  return new Promise(function(resolve, reject){\n    if (!msg.respond) {\n      resolve();\n      return;\n    }\n    waitMessageResponse(self, id, msg.timeout, resolve, reject);\n  });\n};\n\nChannel.prototype.request = function(message) {\n  var msg = message;\n  if (typeof msg !== 'object') {\n    msg = { value: msg };\n  }\n  msg.respond = true;\n  return this.push(msg);\n};\n\nChannel.prototype.originIsAllowed = function (origin) {\n  var filter = this.options.originFilter;\n  if (!filter) {\n    return true;\n  }\n  if (typeof filter.test === 'function') {\n    return filter.test(event.origin);\n  }\n  if (typeof filter === 'string') {\n    return origin === filter;\n  }\n  return false;\n};\n\nfunction handleMessage(self, message, handler) {\n  var respond;\n  if (message.respond) {\n    respond = function(response){\n      var resp = response;\n      if (resp instanceof Error) {\n        resp = { error: resp.message };\n      }\n      if (typeof resp !== 'object') {\n        resp = { value: resp };\n      }\n      resp._responseTo = message._messageid;\n      self.push(resp);\n    };\n  }\n  try {\n    handler(message, respond);\n  } catch (err) {\n    if (console && console.error) {\n      console.error('error on subscriber: ', err);\n      console.error(err.stack);\n    }\n  }\n}\n\nChannel.prototype.subscribe = function (handler) {\n  if (typeof handler !== 'function') {\n    throw new Error('handler function is required');\n  }\n  this.handlers.push(handler);\n  if (!this.listening) {\n    var self = this;\n    var _myWindow = self.findMyWindow();\n    _myWindow.addEventListener('message', function(event) {\n      if (!event.data || event.data.channel !== self.name) {\n        return;\n      }\n      if (!self.originIsAllowed(event.origin)) {\n        return;\n      }\n      var handlers = Array.prototype.slice.apply(self.handlers);\n      while (handlers.length) {\n        handleMessage(self, event.data, handlers.shift());\n      }\n    }, false);\n    this.listening = true;\n\n    this.respondToPings();\n    if (this.options.autoReady !== false) {\n      this.notifyReady();\n    }\n  }\n  return this;\n};\n\nChannel.prototype.respondToPings = function(){\n  if (this.respondingToPings) {\n    return;\n  }\n  this.subscribe(function(message, respond){\n    if (message.ping && respond) {\n      respond({ pong: true });\n    }\n  });\n};\n\nChannel.prototype.notifyReady = function () {\n  this.respondToPings();\n  try {\n    this.push({ ready: true });\n  } catch(err) {\n    // maybe there's no target window yet, just ignore this\n  }\n};\n\nChannel.prototype.unsubscribe = function (handler) {\n  for (var i = this.handlers.length - 1; i >= 0; i--) {\n    if (this.handlers[i] === handler) {\n      this.handlers.splice(i, 1);\n    }\n  }\n  return this;\n};\n\nmodule.exports = Channel;\n","\nvar Promise = require('es6-promise').Promise;\n\nfunction ChannelIFrame(channel){\n  this.channel = channel;\n}\n\nChannelIFrame.prototype.ready = function () {\n  var self = this;\n  var promise = this.readyPromise;\n  if (!promise) {\n    var channel = this.channel;\n    var options = channel.options.iframe;\n    promise = new Promise(function(resolve, reject) {\n\n      var ready = false;\n      var timeout = false;\n\n      var readyListener = function(message){\n        if (ready || timeout || !(message.ready || message.pong)) {\n          return;\n        }\n        // frame is ready and listening!\n        ready = true;\n        channel.unsubscribe(readyListener);\n        resolve();\n      };\n      channel.subscribe(readyListener);\n\n      var element = self.element || document.getElementById(options.id);\n      if (!element) {\n        element = document.createElement('iframe');\n        self.element = element;\n        element.id = options.id;\n        element.style.display = 'none';\n        if (options.allowPositionControl) {\n          self.subscribeToPositionMessages();\n        }\n        document.body.appendChild(element);\n        if (options.url) {\n          element.src = options.url;\n        } else if (options.html) {\n          var doc = element.contentDocument || element.contentWindow.document;\n          doc.write(options.html.toString());\n          doc.close();\n        }\n        if (typeof options.setup === 'function') {\n          options.setup(element);\n        }\n      } else {\n        self.element = element;\n        try {\n          channel.push({ ping: true, respond: true });\n        } catch (err) {\n          console.log('failed to ping frame channel');\n        }\n      }\n\n      setTimeout(function(){\n        if (!ready) {\n          timeout = true;\n          if (console.error) {\n            console.error('timeout waiting for frame channel');\n          }\n          channel.unsubscribe(readyListener);\n          reject(new Error('timeout waiting for frame channel'));\n        }\n      }, options.readyTimeout || 15000);\n    });\n    this.readyPromise = promise;\n  }\n  return promise;\n};\n\n\nChannelIFrame.prototype.subscribeToPositionMessages = function() {\n  // let the iframe control it's own position with messages\n  var iframe = this;\n  this.channel.subscribe(function(msg, respond) {\n    if (msg.maximize) {\n      iframe.maximize();\n    }\n    if (msg.size) {\n      iframe.size(msg.size.width, msg.size.height);\n    }\n    if (msg.restore) {\n      iframe.restore();\n    }\n    if (msg.dock) {\n      iframe.dock(msg.dock);\n    }\n    if (msg.show) {\n      iframe.show();\n    }\n    if (msg.hide) {\n      iframe.hide();\n    }\n    if (respond) {\n      respond();\n    }\n  });\n};\n\nChannelIFrame.prototype.show = function() {\n  this.element.display = '';\n  return this;\n};\n\nChannelIFrame.prototype.hide = function() {\n  this.element.display = 'none';\n  return this;\n};\n\nChannelIFrame.prototype.size = function(width, height) {\n  if (width === '100%' && height === '100%') {\n    return this.maximize();\n  }\n  if (this.preMaximize) {\n    this.restore();\n  }\n  var element = this.element;\n  element.style.width = width;\n  element.style.height = height;\n  return this;\n};\n\nChannelIFrame.prototype.dock = function(location) {\n  location = location || 'bottom right';\n  var left = location.indexOf('left') >= 0;\n  var right = location.indexOf('right') >= 0;\n  var bottom = location.indexOf('bottom') >= 0;\n  var top = location.indexOf('top') >= 0;\n  var element = this.element;\n  element.style.position = 'fixed';\n  element.style.left = left ? 0 : 'auto';\n  element.style.right = right ? 0 : 'auto';\n  element.style.bottom = bottom ? 0 : 'auto';\n  element.style.top = top ? 0 : 'auto';\n  element.style.margin = 0;\n  element.style.padding = 0;\n  element.style.border = 0;\n  element.style.zIndex = 99999999;\n  var pre = this.preMaximize;\n  if (pre) {\n    element.style.width = pre.width;\n    element.style.height = pre.height;\n    this.preMaximize = null;\n  }\n  return this;\n};\n\nChannelIFrame.prototype.maximize = function() {\n  var pre = {};\n  var element = this.element;\n  element.style.position = 'fixed';\n  pre.left = element.style.left;\n  pre.right = element.style.right;\n  pre.bottom = element.style.bottom;\n  pre.top = element.style.top;\n  pre.width = element.style.width;\n  pre.height = element.style.height;\n  element.style.left = 0;\n  element.style.right = 0;\n  element.style.bottom = 0;\n  element.style.top = 0;\n  element.style.width = '100%';\n  element.style.height = '100%';\n  element.contentWindow.focus();\n  if (!this.preMaximize) {\n    this.preMaximize = pre;\n  }\n  return this;\n};\n\nChannelIFrame.prototype.restore = function() {\n  var pre = this.preMaximize;\n  if (!pre) {\n    return;\n  }\n  var element = this.element;\n  for (var name in pre) {\n    element.style[name] = pre[name];\n  }\n  this.preMaximize = null;\n  return this;\n};\n\nmodule.exports = ChannelIFrame;\n","\"use strict\";\nvar Promise = require(\"./promise/promise\").Promise;\nvar polyfill = require(\"./promise/polyfill\").polyfill;\nexports.Promise = Promise;\nexports.polyfill = polyfill;","\"use strict\";\nvar config = require(\"./config\").config;\nvar configure = require(\"./config\").configure;\nvar objectOrFunction = require(\"./utils\").objectOrFunction;\nvar isFunction = require(\"./utils\").isFunction;\nvar now = require(\"./utils\").now;\nvar all = require(\"./all\").all;\nvar race = require(\"./race\").race;\nvar staticResolve = require(\"./resolve\").resolve;\nvar staticReject = require(\"./reject\").reject;\nvar asap = require(\"./asap\").asap;\n\nvar counter = 0;\n\nconfig.async = asap; // default async is asap;\n\nfunction Promise(resolver) {\n  if (!isFunction(resolver)) {\n    throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n  }\n\n  if (!(this instanceof Promise)) {\n    throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n  }\n\n  this._subscribers = [];\n\n  invokeResolver(resolver, this);\n}\n\nfunction invokeResolver(resolver, promise) {\n  function resolvePromise(value) {\n    resolve(promise, value);\n  }\n\n  function rejectPromise(reason) {\n    reject(promise, reason);\n  }\n\n  try {\n    resolver(resolvePromise, rejectPromise);\n  } catch(e) {\n    rejectPromise(e);\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value, error, succeeded, failed;\n\n  if (hasCallback) {\n    try {\n      value = callback(detail);\n      succeeded = true;\n    } catch(e) {\n      failed = true;\n      error = e;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (handleThenable(promise, value)) {\n    return;\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (failed) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    resolve(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nvar PENDING   = void 0;\nvar SEALED    = 0;\nvar FULFILLED = 1;\nvar REJECTED  = 2;\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var subscribers = parent._subscribers;\n  var length = subscribers.length;\n\n  subscribers[length] = child;\n  subscribers[length + FULFILLED] = onFulfillment;\n  subscribers[length + REJECTED]  = onRejection;\n}\n\nfunction publish(promise, settled) {\n  var child, callback, subscribers = promise._subscribers, detail = promise._detail;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    invokeCallback(settled, child, callback, detail);\n  }\n\n  promise._subscribers = null;\n}\n\nPromise.prototype = {\n  constructor: Promise,\n\n  _state: undefined,\n  _detail: undefined,\n  _subscribers: undefined,\n\n  then: function(onFulfillment, onRejection) {\n    var promise = this;\n\n    var thenPromise = new this.constructor(function() {});\n\n    if (this._state) {\n      var callbacks = arguments;\n      config.async(function invokePromiseCallback() {\n        invokeCallback(promise._state, thenPromise, callbacks[promise._state - 1], promise._detail);\n      });\n    } else {\n      subscribe(this, thenPromise, onFulfillment, onRejection);\n    }\n\n    return thenPromise;\n  },\n\n  'catch': function(onRejection) {\n    return this.then(null, onRejection);\n  }\n};\n\nPromise.all = all;\nPromise.race = race;\nPromise.resolve = staticResolve;\nPromise.reject = staticReject;\n\nfunction handleThenable(promise, value) {\n  var then = null,\n  resolved;\n\n  try {\n    if (promise === value) {\n      throw new TypeError(\"A promises callback cannot return that same promise.\");\n    }\n\n    if (objectOrFunction(value)) {\n      then = value.then;\n\n      if (isFunction(then)) {\n        then.call(value, function(val) {\n          if (resolved) { return true; }\n          resolved = true;\n\n          if (value !== val) {\n            resolve(promise, val);\n          } else {\n            fulfill(promise, val);\n          }\n        }, function(val) {\n          if (resolved) { return true; }\n          resolved = true;\n\n          reject(promise, val);\n        });\n\n        return true;\n      }\n    }\n  } catch (error) {\n    if (resolved) { return true; }\n    reject(promise, error);\n    return true;\n  }\n\n  return false;\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    fulfill(promise, value);\n  } else if (!handleThenable(promise, value)) {\n    fulfill(promise, value);\n  }\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) { return; }\n  promise._state = SEALED;\n  promise._detail = value;\n\n  config.async(publishFulfillment, promise);\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) { return; }\n  promise._state = SEALED;\n  promise._detail = reason;\n\n  config.async(publishRejection, promise);\n}\n\nfunction publishFulfillment(promise) {\n  publish(promise, promise._state = FULFILLED);\n}\n\nfunction publishRejection(promise) {\n  publish(promise, promise._state = REJECTED);\n}\n\nexports.Promise = Promise;","(function (global){\n\"use strict\";\n/*global self*/\nvar RSVPPromise = require(\"./promise\").Promise;\nvar isFunction = require(\"./utils\").isFunction;\n\nfunction polyfill() {\n  var local;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof window !== 'undefined' && window.document) {\n    local = window;\n  } else {\n    local = self;\n  }\n\n  var es6PromiseSupport = \n    \"Promise\" in local &&\n    // Some of these methods are missing from\n    // Firefox/Chrome experimental implementations\n    \"resolve\" in local.Promise &&\n    \"reject\" in local.Promise &&\n    \"all\" in local.Promise &&\n    \"race\" in local.Promise &&\n    // Older version of the spec had a resolver object\n    // as the arg rather than a function\n    (function() {\n      var resolve;\n      new local.Promise(function(r) { resolve = r; });\n      return isFunction(resolve);\n    }());\n\n  if (!es6PromiseSupport) {\n    local.Promise = RSVPPromise;\n  }\n}\n\nexports.polyfill = polyfill;\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})","\"use strict\";\nvar config = {\n  instrument: false\n};\n\nfunction configure(name, value) {\n  if (arguments.length === 2) {\n    config[name] = value;\n  } else {\n    return config[name];\n  }\n}\n\nexports.config = config;\nexports.configure = configure;","\"use strict\";\nfunction objectOrFunction(x) {\n  return isFunction(x) || (typeof x === \"object\" && x !== null);\n}\n\nfunction isFunction(x) {\n  return typeof x === \"function\";\n}\n\nfunction isArray(x) {\n  return Object.prototype.toString.call(x) === \"[object Array]\";\n}\n\n// Date.now is not available in browsers < IE9\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/now#Compatibility\nvar now = Date.now || function() { return new Date().getTime(); };\n\n\nexports.objectOrFunction = objectOrFunction;\nexports.isFunction = isFunction;\nexports.isArray = isArray;\nexports.now = now;","\"use strict\";\n/* global toString */\n\nvar isArray = require(\"./utils\").isArray;\nvar isFunction = require(\"./utils\").isFunction;\n\n/**\n  Returns a promise that is fulfilled when all the given promises have been\n  fulfilled, or rejected if any of them become rejected. The return promise\n  is fulfilled with an array that gives all the values in the order they were\n  passed in the `promises` array argument.\n\n  Example:\n\n  ```javascript\n  var promise1 = RSVP.resolve(1);\n  var promise2 = RSVP.resolve(2);\n  var promise3 = RSVP.resolve(3);\n  var promises = [ promise1, promise2, promise3 ];\n\n  RSVP.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `RSVP.all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  var promise1 = RSVP.resolve(1);\n  var promise2 = RSVP.reject(new Error(\"2\"));\n  var promise3 = RSVP.reject(new Error(\"3\"));\n  var promises = [ promise1, promise2, promise3 ];\n\n  RSVP.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @for RSVP\n  @param {Array} promises\n  @param {String} label\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n*/\nfunction all(promises) {\n  /*jshint validthis:true */\n  var Promise = this;\n\n  if (!isArray(promises)) {\n    throw new TypeError('You must pass an array to all.');\n  }\n\n  return new Promise(function(resolve, reject) {\n    var results = [], remaining = promises.length,\n    promise;\n\n    if (remaining === 0) {\n      resolve([]);\n    }\n\n    function resolver(index) {\n      return function(value) {\n        resolveAll(index, value);\n      };\n    }\n\n    function resolveAll(index, value) {\n      results[index] = value;\n      if (--remaining === 0) {\n        resolve(results);\n      }\n    }\n\n    for (var i = 0; i < promises.length; i++) {\n      promise = promises[i];\n\n      if (promise && isFunction(promise.then)) {\n        promise.then(resolver(i), reject);\n      } else {\n        resolveAll(i, promise);\n      }\n    }\n  });\n}\n\nexports.all = all;","\"use strict\";\n/* global toString */\nvar isArray = require(\"./utils\").isArray;\n\n/**\n  `RSVP.race` allows you to watch a series of promises and act as soon as the\n  first promise given to the `promises` argument fulfills or rejects.\n\n  Example:\n\n  ```javascript\n  var promise1 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve(\"promise 1\");\n    }, 200);\n  });\n\n  var promise2 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve(\"promise 2\");\n    }, 100);\n  });\n\n  RSVP.race([promise1, promise2]).then(function(result){\n    // result === \"promise 2\" because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `RSVP.race` is deterministic in that only the state of the first completed\n  promise matters. For example, even if other promises given to the `promises`\n  array argument are resolved, but the first completed promise has become\n  rejected before the other promises became fulfilled, the returned promise\n  will become rejected:\n\n  ```javascript\n  var promise1 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve(\"promise 1\");\n    }, 200);\n  });\n\n  var promise2 = new RSVP.Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error(\"promise 2\"));\n    }, 100);\n  });\n\n  RSVP.race([promise1, promise2]).then(function(result){\n    // Code here never runs because there are rejected promises!\n  }, function(reason){\n    // reason.message === \"promise2\" because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  @method race\n  @for RSVP\n  @param {Array} promises array of promises to observe\n  @param {String} label optional string for describing the promise returned.\n  Useful for tooling.\n  @return {Promise} a promise that becomes fulfilled with the value the first\n  completed promises is resolved with if the first completed promise was\n  fulfilled, or rejected with the reason that the first completed promise\n  was rejected with.\n*/\nfunction race(promises) {\n  /*jshint validthis:true */\n  var Promise = this;\n\n  if (!isArray(promises)) {\n    throw new TypeError('You must pass an array to race.');\n  }\n  return new Promise(function(resolve, reject) {\n    var results = [], promise;\n\n    for (var i = 0; i < promises.length; i++) {\n      promise = promises[i];\n\n      if (promise && typeof promise.then === 'function') {\n        promise.then(resolve, reject);\n      } else {\n        resolve(promise);\n      }\n    }\n  });\n}\n\nexports.race = race;","\"use strict\";\nfunction resolve(value) {\n  /*jshint validthis:true */\n  if (value && typeof value === 'object' && value.constructor === this) {\n    return value;\n  }\n\n  var Promise = this;\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n}\n\nexports.resolve = resolve;","\"use strict\";\n/**\n  `RSVP.reject` returns a promise that will become rejected with the passed\n  `reason`. `RSVP.reject` is essentially shorthand for the following:\n\n  ```javascript\n  var promise = new RSVP.Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  var promise = RSVP.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @for RSVP\n  @param {Any} reason value that the returned promise will be rejected with.\n  @param {String} label optional string for identifying the returned promise.\n  Useful for tooling.\n  @return {Promise} a promise that will become rejected with the given\n  `reason`.\n*/\nfunction reject(reason) {\n  /*jshint validthis:true */\n  var Promise = this;\n\n  return new Promise(function (resolve, reject) {\n    reject(reason);\n  });\n}\n\nexports.reject = reject;","(function (process,global){\n\"use strict\";\nvar browserGlobal = (typeof window !== 'undefined') ? window : {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar local = (typeof global !== 'undefined') ? global : (this === undefined? window:this);\n\n// node\nfunction useNextTick() {\n  return function() {\n    process.nextTick(flush);\n  };\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function() {\n    node.data = (iterations = ++iterations % 2);\n  };\n}\n\nfunction useSetTimeout() {\n  return function() {\n    local.setTimeout(flush, 1);\n  };\n}\n\nvar queue = [];\nfunction flush() {\n  for (var i = 0; i < queue.length; i++) {\n    var tuple = queue[i];\n    var callback = tuple[0], arg = tuple[1];\n    callback(arg);\n  }\n  queue = [];\n}\n\nvar scheduleFlush;\n\n// Decide what async method to use to triggering processing of queued callbacks:\nif (typeof process !== 'undefined' && {}.toString.call(process) === '[object process]') {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction asap(callback, arg) {\n  var length = queue.push([callback, arg]);\n  if (length === 1) {\n    // If length is 1, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    scheduleFlush();\n  }\n}\n\nexports.asap = asap;\n}).call(this,require('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})"]}